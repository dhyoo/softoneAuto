# SoftOne Auto Manager 배포 가이드

## 📦 EXE 파일 생성 방법

### 사전 요구사항
- **JDK 14 이상** (jpackage 도구 포함)
- **Windows 10 이상** (EXE 빌드용)

### 빌드 방법

#### 1. JAR 파일 생성
```bash
gradlew.bat clean build
```

#### 2. EXE 파일 생성 (App Image)
```bash
gradlew.bat createExe
```
- 생성 위치: `build/distributions/exe/SoftOneAutoManager/`
- 실행 파일: `SoftOneAutoManager.exe`

#### 3. MSI 인스톨러 생성 (권장)
```bash
gradlew.bat createInstaller
```
- 생성 위치: `build/distributions/installer/`
- 인스톨러 파일: `SoftOneAutoManager-1.0.0.msi`

## 🔒 배포 시 데이터 초기화 관련

### ❓ EXE 파일로 만들면 모든 데이터가 초기화되는가?

**아니요. EXE 파일은 실행 파일일 뿐이며, 데이터는 별도로 저장됩니다.**

- **EXE 파일 자체**: 실행 파일과 라이브러리만 포함
- **사용자 데이터**: `%USERPROFILE%\SoftOneAutoData\` 또는 사용자가 선택한 경로에 저장
- **설정 파일**: `config.json` (EXE와 같은 디렉토리 또는 사용자 데이터 경로)

### 📂 데이터 저장 위치

1. **기본 위치**: `C:\Users\[사용자명]\SoftOneAutoData\`
   - `data/` - SQLite 데이터베이스 및 데이터 파일
   - `reports/` - 생성된 Excel/PDF 보고서
   - `logs/` - 로그 파일
   - `backup/` - 백업 파일

2. **설정 파일**: EXE 실행 디렉토리의 `config.json`
   - 애플리케이션 설정
   - 데이터 경로 설정
   - 마지막 선택 회사 정보

### 🚫 샘플 데이터 제거

**배포 시 샘플 데이터는 자동으로 생성되지 않습니다.**

#### 자동 제거 메커니즘

1. **EXE 빌드 시 자동 설정**
   - `build.gradle`의 `createExe` 및 `createInstaller` 태스크에서
   - `--java-options '-Dsoftone.app.mode=PRODUCTION'` 옵션으로 프로덕션 모드 설정
   - 프로덕션 모드에서는 샘플 데이터가 생성되지 않음

2. **애플리케이션 모드 확인**
   ```java
   // AppConfig.java
   public boolean isSampleDataEnabled() {
       return enableSampleData && getApplicationMode() != ApplicationMode.PRODUCTION;
   }
   ```

3. **MainFrame에서 조건부 실행**
   ```java
   if (config.isSampleDataEnabled()) {
       initializeSampleData();  // 프로덕션 모드에서는 실행되지 않음
   } else {
       loadCompanies();  // 기존 데이터만 로드
   }
   ```

#### 수동 확인 방법

EXE 실행 후 다음을 확인하세요:

1. **애플리케이션 모드 확인**
   - 콘솔 출력에서 `=== 애플리케이션 모드: PRODUCTION ===` 확인
   - 콘솔 출력에서 `=== 샘플 데이터 활성화: false ===` 확인

2. **데이터 확인**
   - "파견회사 관리" 탭에서 회사 목록이 비어있는지 확인
   - "개발자 관리" 탭에서 개발자 목록이 비어있는지 확인
   - "주간보고서" 탭에서 보고서 목록이 비어있는지 확인

## 📋 배포 체크리스트

### 빌드 전 확인
- [ ] `build.gradle`에서 버전 번호 확인
- [ ] 모든 테스트 통과 확인
- [ ] 샘플 데이터 생성 코드가 조건부로 실행되는지 확인

### 빌드 후 확인
- [ ] EXE 파일이 정상적으로 생성되었는지 확인
- [ ] EXE 실행 시 프로덕션 모드로 시작하는지 확인
- [ ] 샘플 데이터가 생성되지 않는지 확인
- [ ] 데이터 저장 경로가 올바르게 설정되는지 확인

### 배포 전 테스트
- [ ] 새로운 Windows 환경에서 EXE 실행 테스트
- [ ] 데이터 저장/로드 기능 테스트
- [ ] Excel/PDF 생성 기능 테스트
- [ ] 모든 탭의 CRUD 기능 테스트

## 🔧 환경 변수 설정 (선택사항)

배포 후에도 환경 변수로 모드를 변경할 수 있습니다:

```bash
# 프로덕션 모드 (기본값)
set SOFTONE_APP_MODE=PRODUCTION

# 개발 모드 (디버깅용)
set SOFTONE_APP_MODE=DEVELOPMENT

# 데모 모드
set SOFTONE_APP_MODE=DEMO
```

## 📝 배포 시 주의사항

1. **데이터 마이그레이션**
   - 기존 사용자의 데이터는 자동으로 마이그레이션됩니다
   - SQLite 데이터베이스는 자동으로 생성됩니다

2. **설정 파일**
   - 첫 실행 시 데이터 저장 위치를 선택하도록 안내됩니다
   - 기본 위치: `%USERPROFILE%\SoftOneAutoData\`

3. **의존성**
   - EXE 파일에는 모든 의존성이 포함되어 있습니다
   - 별도의 Java 설치가 필요 없습니다 (jpackage가 포함된 JRE 포함)

4. **라이선스**
   - iText 5.x는 AGPL 라이선스입니다
   - 상용 배포 시 라이선스 확인이 필요합니다

## 🐛 문제 해결

### EXE 실행 시 오류 발생
1. Windows Defender 또는 백신 프로그램에서 차단되는지 확인
2. 관리자 권한으로 실행 시도
3. 로그 파일 확인: `%USERPROFILE%\SoftOneAutoData\logs\softone.log`

### 샘플 데이터가 생성되는 경우
1. 환경 변수 확인: `echo %SOFTONE_APP_MODE%`
2. 설정 파일 확인: EXE 디렉토리의 `config.json`
3. 콘솔 출력에서 애플리케이션 모드 확인

