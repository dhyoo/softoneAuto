# Java Swing ì• í”Œë¦¬ì¼€ì´ì…˜ í•µì‹¬ ë°ì´í„° ì²˜ë¦¬ ë¡œì§ ë¶„ì„ ë³´ê³ ì„œ

## ê°œìš”
ë³¸ ë³´ê³ ì„œëŠ” `softoneAuto` Java Swing ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í•µì‹¬ ë°ì´í„° ì²˜ë¦¬ ë¡œì§ì„ ë‹¤ìŒ ì„¸ ê°€ì§€ ê¸°ìˆ ì  ê´€ì ì—ì„œ ë¶„ì„í•œ ê²°ê³¼ë¥¼ ì œì‹œí•©ë‹ˆë‹¤:
1. ìƒíƒœ ê´€ë¦¬ì˜ ì •ìƒì„± (ìŠ¤ë ˆë“œ ì•ˆì „ì„±)
2. ë°ì´í„° ë¬´ê²°ì„± ê²€ì¦
3. ì˜¤ë¥˜ ì²˜ë¦¬ ë©”ì»¤ë‹ˆì¦˜

---

## 1. ìƒíƒœ ê´€ë¦¬ì˜ ì •ìƒì„± (Thread Safety) ë¶„ì„

### 1.1 ë°œê²¬ëœ ë¬¸ì œì 

#### ğŸ”´ **ì‹¬ê°: ë¹„ë™ê¸°í™”ëœ ê³µìœ  ë°ì´í„° êµ¬ì¡°**

**ìœ„ì¹˜:** `WeeklyReportPanel.java:52`
```java
private List<WeeklyReport> cachedReports = new ArrayList<>();
```

**ë¬¸ì œì :**
- `ArrayList`ëŠ” ìŠ¤ë ˆë“œ ì•ˆì „í•˜ì§€ ì•Šì€ ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
- `loadReports()` ë©”ì„œë“œê°€ EDT(Event Dispatch Thread) ì™¸ë¶€ì—ì„œ ì‹¤í–‰ë  ìˆ˜ ìˆìœ¼ë©°, ë™ì‹œì— ì—¬ëŸ¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ `cachedReports`ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- `SwingUtilities.invokeLater()`ëŠ” ì‘ì—…ì„ íì— ë„£ì„ ë¿, ì‹¤ì œ ì‹¤í–‰ ì‹œì ì˜ ë™ê¸°í™”ë¥¼ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

**ìœ„í—˜ ì‹œë‚˜ë¦¬ì˜¤:**
```java
// ì‹œë‚˜ë¦¬ì˜¤ 1: ë™ì‹œ ì ‘ê·¼ìœ¼ë¡œ ì¸í•œ ë°ì´í„° ë¶ˆì¼ì¹˜
Thread A: loadReports() ì‹¤í–‰ â†’ cachedReports.clear()
Thread B: onReportSelected() ì‹¤í–‰ â†’ cachedReports.get(selectedRow) // IndexOutOfBoundsException ê°€ëŠ¥
```

**ìœ„ì¹˜:** `WeeklyReportPanel.java:145-176`
```java
// ListSelectionListener, MouseListener, KeyListenerê°€ ëª¨ë‘ ë™ì¼í•œ ì‘ì—…ì„ ìˆ˜í–‰
reportTable.getSelectionModel().addListSelectionListener(e -> {
    if (!e.getValueIsAdjusting()) {
        SwingUtilities.invokeLater(() -> onReportSelected()); // ë¹„ë™ê¸° ì‹¤í–‰
    }
});

reportTable.addMouseListener(new java.awt.event.MouseAdapter() {
    @Override
    public void mouseClicked(java.awt.event.MouseEvent evt) {
        SwingUtilities.invokeLater(() -> onReportSelected()); // ì¤‘ë³µ ì‹¤í–‰ ê°€ëŠ¥
    }
});
```

**ë¬¸ì œì :**
- ì„¸ ê°œì˜ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ë™ì¼í•œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ì—¬ `onReportSelected()`ê°€ ì¤‘ë³µ ì‹¤í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- `SwingUtilities.invokeLater()`ë¡œ ì¸í•´ ì‹¤ì œ ì‹¤í–‰ ìˆœì„œê°€ ë³´ì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

#### ğŸŸ¡ **ì¤‘ê°„: DefaultTableModelê³¼ ìºì‹œ ê°„ ë™ê¸°í™” ë¶€ì¡±**

**ìœ„ì¹˜:** `WeeklyReportPanel.java:621-734`
```java
private void loadReports() {
    // ...
    cachedReports.clear();
    cachedReports.addAll(newReports);
    
    tableModel.setRowCount(0);  // í…Œì´ë¸” ì´ˆê¸°í™”
    
    for (int i = 0; i < cachedReports.size(); i++) {
        WeeklyReport report = cachedReports.get(i);
        tableModel.addRow(new Object[]{...});
    }
}
```

**ë¬¸ì œì :**
- `cachedReports`ì™€ `tableModel` ê°„ì˜ ë™ê¸°í™”ê°€ ì›ìì (atomic)ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.
- `cachedReports` ì—…ë°ì´íŠ¸ì™€ `tableModel` ì—…ë°ì´íŠ¸ ì‚¬ì´ì— ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ê°œì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 1.2 ê°œì„  ë°©ì•ˆ

#### âœ… **í•´ê²°ì±… 1: ìŠ¤ë ˆë“œ ì•ˆì „ ì»¬ë ‰ì…˜ ì‚¬ìš©**

```java
import java.util.Collections;
import java.util.List;
import java.util.concurrent.CopyOnWriteArrayList;

// ë³€ê²½ ì „
private List<WeeklyReport> cachedReports = new ArrayList<>();

// ë³€ê²½ í›„
private final List<WeeklyReport> cachedReports = 
    Collections.synchronizedList(new ArrayList<>());
// ë˜ëŠ” ë” ë‚˜ì€ ë°©ë²•:
private final List<WeeklyReport> cachedReports = new CopyOnWriteArrayList<>();
```

**ì¥ì :**
- `CopyOnWriteArrayList`ëŠ” ì½ê¸° ì‘ì—…ì´ ë§ê³  ì“°ê¸° ì‘ì—…ì´ ì ì„ ë•Œ ìµœì ì…ë‹ˆë‹¤.
- ë‚´ë¶€ì ìœ¼ë¡œ ë³µì‚¬ë³¸ì„ ìƒì„±í•˜ì—¬ ìŠ¤ë ˆë“œ ì•ˆì „ì„±ì„ ë³´ì¥í•©ë‹ˆë‹¤.

#### âœ… **í•´ê²°ì±… 2: ë™ê¸°í™” ë¸”ë¡ ì¶”ê°€**

```java
private final Object cacheLock = new Object();

private void loadReports() {
    synchronized (cacheLock) {
        // í˜„ì¬ ì„ íƒëœ ë³´ê³ ì„œ ID ì €ì¥
        String currentReportId = (currentReport != null) ? currentReport.getId() : null;
        
        // ë°±ì—… ìƒì„±
        List<WeeklyReport> backupReports = new ArrayList<>(cachedReports);
        
        try {
            List<WeeklyReport> newReports = reportService.getAllReports();
            newReports.sort((r1, r2) -> r2.getStartDate().compareTo(r1.getStartDate()));
            
            // ì›ìì  ì—…ë°ì´íŠ¸
            cachedReports.clear();
            cachedReports.addAll(newReports);
            
            // UI ì—…ë°ì´íŠ¸ëŠ” EDTì—ì„œ ì‹¤í–‰
            SwingUtilities.invokeLater(() -> {
                synchronized (cacheLock) {
                    updateTableModel(newReports);
                }
            });
        } catch (Exception e) {
            // ì˜ˆì™¸ ì²˜ë¦¬
        }
    }
}

private void onReportSelected() {
    int selectedRow = reportTable.getSelectedRow();
    
    synchronized (cacheLock) {
        if (selectedRow < 0 || selectedRow >= cachedReports.size()) {
            return;
        }
        
        WeeklyReport report = cachedReports.get(selectedRow);
        // ...
    }
}
```

#### âœ… **í•´ê²°ì±… 3: ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¤‘ë³µ ì œê±°**

```java
// ë‹¨ì¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¡œ í†µí•©
private void setupTableSelectionListener() {
    reportTable.getSelectionModel().addListSelectionListener(e -> {
        if (!e.getValueIsAdjusting()) {
            SwingUtilities.invokeLater(() -> onReportSelected());
        }
    });
    
    // MouseListenerì™€ KeyListenerëŠ” ì œê±°í•˜ê±°ë‚˜, 
    // ë‹¨ìˆœíˆ ì„ íƒë§Œ ë³€ê²½í•˜ê³  ListSelectionListenerì— ìœ„ì„
    reportTable.addMouseListener(new java.awt.event.MouseAdapter() {
        @Override
        public void mouseClicked(java.awt.event.MouseEvent evt) {
            int row = reportTable.rowAtPoint(evt.getPoint());
            if (row >= 0) {
                reportTable.setRowSelectionInterval(row, row);
                // ListSelectionListenerê°€ ìë™ìœ¼ë¡œ í˜¸ì¶œë¨
            }
        }
    });
}
```

---

## 2. ë°ì´í„° ë¬´ê²°ì„± ê²€ì¦ ë¶„ì„

### 2.1 ë°œê²¬ëœ ë¬¸ì œì 

#### ğŸ”´ **ì‹¬ê°: ì²´í¬ì„¬/í•´ì‹± ë©”ì»¤ë‹ˆì¦˜ ë¶€ì¬**

**ìœ„ì¹˜:** `JsonRepository.java:222-358`, `WeeklyReportRepository.java:57-100`

**í˜„ì¬ êµ¬í˜„:**
```java
// JsonRepository.java
public void saveAll(List<T> list) {
    // ì„ì‹œ íŒŒì¼ì— ì €ì¥
    File tempFile = new File(dataDirectory, fileName + ".tmp");
    Writer writer = new OutputStreamWriter(...);
    gson.toJson(list, writer);
    writer.close();
    
    // JSON íŒŒì‹± ê²€ì¦ë§Œ ìˆ˜í–‰
    List<T> verification = gson.fromJson(reader, type);
    if (verification.size() != list.size()) {
        throw new IOException("í¬ê¸° ë¶ˆì¼ì¹˜");
    }
    
    // ë©”ì¸ íŒŒì¼ë¡œ ì´ë™
    Files.move(tempFile.toPath(), file.toPath(), ...);
}
```

**ë¬¸ì œì :**
1. **ë°ì´í„° ë³€ì¡° ê°ì§€ ë¶ˆê°€ëŠ¥**: íŒŒì¼ì´ ì™¸ë¶€ì—ì„œ ìˆ˜ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
2. **ë¶€ë¶„ ì†ìƒ ê°ì§€ ë¶ˆê°€ëŠ¥**: JSON íŒŒì‹±ì€ ì„±ê³µí•˜ì§€ë§Œ ì¼ë¶€ í•„ë“œê°€ ì†ìƒë˜ì—ˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
3. **ë¬´ê²°ì„± ê²€ì¦ ì—†ìŒ**: ì €ì¥ëœ ë°ì´í„°ê°€ ì›ë³¸ê³¼ ë™ì¼í•œì§€ í™•ì¸í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì´ ì—†ìŠµë‹ˆë‹¤.

**ìœ„ì¹˜:** `WeeklyReportRepository.java:227-241`
```java
private List<WeeklyReport> loadFromFile(String filePath) {
    try (FileReader reader = new FileReader(file)) {
        List<WeeklyReport> reports = gson.fromJson(reader, TYPE);
        return reports != null ? reports : new ArrayList<>();
    } catch (Exception e) {
        System.err.println("íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨: " + filePath + " - " + e.getMessage());
        return new ArrayList<>(); // ì†ìƒëœ íŒŒì¼ë„ ë¹ˆ ë¦¬ìŠ¤íŠ¸ë¡œ ì²˜ë¦¬
    }
}
```

**ë¬¸ì œì :**
- íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ë‹¨ìˆœíˆ ë¹ˆ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•˜ì—¬ ë°ì´í„° ì†ì‹¤ì„ ê°ì§€í•˜ì§€ ëª»í•©ë‹ˆë‹¤.
- ì†ìƒëœ íŒŒì¼ì— ëŒ€í•œ ë³µêµ¬ ë©”ì»¤ë‹ˆì¦˜ì´ ì—†ìŠµë‹ˆë‹¤.

### 2.2 ê°œì„  ë°©ì•ˆ

#### âœ… **í•´ê²°ì±… 1: SHA-256 í•´ì‹œ ê¸°ë°˜ ë¬´ê²°ì„± ê²€ì¦**

```java
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.Base64;

public class JsonRepository<T> {
    
    /**
     * ë°ì´í„° ì €ì¥ ì‹œ í•´ì‹œ ìƒì„± ë° ê²€ì¦
     */
    public void saveAll(List<T> list) {
        // 1. ë°ì´í„° ì§ë ¬í™”
        String jsonData = gson.toJson(list);
        
        // 2. í•´ì‹œ ê³„ì‚°
        String dataHash = calculateHash(jsonData);
        
        // 3. ë©”íƒ€ë°ì´í„° ìƒì„±
        DataMetadata metadata = new DataMetadata();
        metadata.setDataHash(dataHash);
        metadata.setRecordCount(list.size());
        metadata.setTimestamp(System.currentTimeMillis());
        
        // 4. ì„ì‹œ íŒŒì¼ì— ë°ì´í„°ì™€ ë©”íƒ€ë°ì´í„° ì €ì¥
        File tempFile = new File(dataDirectory, fileName + ".tmp");
        try (FileWriter writer = new FileWriter(tempFile)) {
            // JSON ë°ì´í„°ì™€ ë©”íƒ€ë°ì´í„°ë¥¼ í•¨ê»˜ ì €ì¥
            String metadataJson = gson.toJson(metadata);
            writer.write(metadataJson + "\n"); // ì²« ì¤„: ë©”íƒ€ë°ì´í„°
            writer.write(jsonData);            // ë‚˜ë¨¸ì§€: ì‹¤ì œ ë°ì´í„°
        }
        
        // 5. ê²€ì¦: ì €ì¥ëœ íŒŒì¼ì˜ í•´ì‹œ í™•ì¸
        String savedHash = verifyAndGetHash(tempFile);
        if (!dataHash.equals(savedHash)) {
            throw new IOException("ë°ì´í„° ë¬´ê²°ì„± ê²€ì¦ ì‹¤íŒ¨: í•´ì‹œ ë¶ˆì¼ì¹˜");
        }
        
        // 6. ë©”ì¸ íŒŒì¼ë¡œ ì´ë™
        Files.move(tempFile.toPath(), file.toPath(), ...);
    }
    
    /**
     * í•´ì‹œ ê³„ì‚° (SHA-256)
     */
    private String calculateHash(String data) {
        try {
            MessageDigest digest = MessageDigest.getInstance("SHA-256");
            byte[] hashBytes = digest.digest(data.getBytes(StandardCharsets.UTF_8));
            return Base64.getEncoder().encodeToString(hashBytes);
        } catch (NoSuchAlgorithmException e) {
            throw new RuntimeException("í•´ì‹œ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤", e);
        }
    }
    
    /**
     * íŒŒì¼ì—ì„œ ë©”íƒ€ë°ì´í„°ì™€ ë°ì´í„°ë¥¼ ë¶„ë¦¬í•˜ì—¬ ê²€ì¦
     */
    private String verifyAndGetHash(File file) throws IOException {
        try (BufferedReader reader = new BufferedReader(
                new FileReader(file, StandardCharsets.UTF_8))) {
            // ì²« ì¤„: ë©”íƒ€ë°ì´í„°
            String metadataLine = reader.readLine();
            DataMetadata metadata = gson.fromJson(metadataLine, DataMetadata.class);
            
            // ë‚˜ë¨¸ì§€: ë°ì´í„°
            StringBuilder dataBuilder = new StringBuilder();
            String line;
            while ((line = reader.readLine()) != null) {
                dataBuilder.append(line).append("\n");
            }
            String data = dataBuilder.toString().trim();
            
            // í•´ì‹œ ê²€ì¦
            String calculatedHash = calculateHash(data);
            if (!calculatedHash.equals(metadata.getDataHash())) {
                throw new IOException("ë°ì´í„° ë¬´ê²°ì„± ê²€ì¦ ì‹¤íŒ¨");
            }
            
            return calculatedHash;
        }
    }
    
    /**
     * ë°ì´í„° ë¡œë“œ ì‹œ ë¬´ê²°ì„± ê²€ì¦
     */
    public List<T> findAll() {
        File file = new File(dataDirectory, fileName);
        if (!file.exists()) {
            return new ArrayList<>();
        }
        
        try (BufferedReader reader = new BufferedReader(
                new FileReader(file, StandardCharsets.UTF_8))) {
            // ë©”íƒ€ë°ì´í„° ì½ê¸°
            String metadataLine = reader.readLine();
            DataMetadata metadata = gson.fromJson(metadataLine, DataMetadata.class);
            
            // ë°ì´í„° ì½ê¸°
            StringBuilder dataBuilder = new StringBuilder();
            String line;
            while ((line = reader.readLine()) != null) {
                dataBuilder.append(line).append("\n");
            }
            String data = dataBuilder.toString().trim();
            
            // ë¬´ê²°ì„± ê²€ì¦
            String calculatedHash = calculateHash(data);
            if (!calculatedHash.equals(metadata.getDataHash())) {
                log.error("ë°ì´í„° ë¬´ê²°ì„± ê²€ì¦ ì‹¤íŒ¨: {} - í•´ì‹œ ë¶ˆì¼ì¹˜", fileName);
                // ë°±ì—… íŒŒì¼ì—ì„œ ë³µì› ì‹œë„
                return restoreFromBackup();
            }
            
            // íŒŒì‹±
            List<T> list = gson.fromJson(data, type);
            if (list == null) {
                return new ArrayList<>();
            }
            
            // ë ˆì½”ë“œ ìˆ˜ ê²€ì¦
            if (list.size() != metadata.getRecordCount()) {
                log.warn("ë ˆì½”ë“œ ìˆ˜ ë¶ˆì¼ì¹˜: ì˜ˆìƒ {}, ì‹¤ì œ {}", 
                        metadata.getRecordCount(), list.size());
            }
            
            return list;
        } catch (Exception e) {
            log.error("ë°ì´í„° ì½ê¸° ì‹¤íŒ¨: {} - {}", fileName, e.getMessage());
            return restoreFromBackup();
        }
    }
    
    /**
     * ë©”íƒ€ë°ì´í„° í´ë˜ìŠ¤
     */
    private static class DataMetadata {
        private String dataHash;
        private int recordCount;
        private long timestamp;
        
        // Getters and Setters
        public String getDataHash() { return dataHash; }
        public void setDataHash(String dataHash) { this.dataHash = dataHash; }
        public int getRecordCount() { return recordCount; }
        public void setRecordCount(int recordCount) { this.recordCount = recordCount; }
        public long getTimestamp() { return timestamp; }
        public void setTimestamp(long timestamp) { this.timestamp = timestamp; }
    }
}
```

#### âœ… **í•´ê²°ì±… 2: ì²´í¬ì„¬ íŒŒì¼ ë¶„ë¦¬ ì €ì¥**

```java
/**
 * ì²´í¬ì„¬ íŒŒì¼ì„ ë³„ë„ë¡œ ê´€ë¦¬
 */
private void saveWithChecksum(List<T> list) throws IOException {
    // 1. ë°ì´í„° ì €ì¥
    File dataFile = new File(dataDirectory, fileName);
    try (FileWriter writer = new FileWriter(dataFile)) {
        gson.toJson(list, writer);
    }
    
    // 2. ì²´í¬ì„¬ ê³„ì‚° ë° ì €ì¥
    String checksum = calculateChecksum(dataFile);
    File checksumFile = new File(dataDirectory, fileName + ".checksum");
    try (FileWriter writer = new FileWriter(checksumFile)) {
        writer.write(checksum);
    }
    
    // 3. ê²€ì¦
    String savedChecksum = readChecksum(checksumFile);
    if (!checksum.equals(savedChecksum)) {
        throw new IOException("ì²´í¬ì„¬ ë¶ˆì¼ì¹˜: ë°ì´í„°ê°€ ì†ìƒë˜ì—ˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤");
    }
}

private String calculateChecksum(File file) throws IOException {
    try (FileInputStream fis = new FileInputStream(file)) {
        MessageDigest digest = MessageDigest.getInstance("SHA-256");
        byte[] buffer = new byte[8192];
        int bytesRead;
        while ((bytesRead = fis.read(buffer)) != -1) {
            digest.update(buffer, 0, bytesRead);
        }
        return Base64.getEncoder().encodeToString(digest.digest());
    } catch (NoSuchAlgorithmException e) {
        throw new RuntimeException("í•´ì‹œ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤", e);
    }
}
```

#### âœ… **í•´ê²°ì±… 3: WeeklyReportRepository ê°œì„ **

```java
public class WeeklyReportRepository {
    
    /**
     * íŒŒì¼ ë¡œë“œ ì‹œ ë¬´ê²°ì„± ê²€ì¦ ì¶”ê°€
     */
    private List<WeeklyReport> loadFromFile(String filePath) {
        File file = new File(filePath);
        
        if (!file.exists()) {
            return new ArrayList<>();
        }
        
        // ì²´í¬ì„¬ íŒŒì¼ í™•ì¸
        File checksumFile = new File(filePath + ".checksum");
        if (checksumFile.exists()) {
            try {
                String expectedChecksum = Files.readString(checksumFile.toPath()).trim();
                String actualChecksum = calculateChecksum(file);
                
                if (!expectedChecksum.equals(actualChecksum)) {
                    log.error("íŒŒì¼ ë¬´ê²°ì„± ê²€ì¦ ì‹¤íŒ¨: {} - ì²´í¬ì„¬ ë¶ˆì¼ì¹˜", filePath);
                    // ë°±ì—… íŒŒì¼ì—ì„œ ë³µì› ì‹œë„
                    return restoreFromBackup(filePath);
                }
            } catch (Exception e) {
                log.warn("ì²´í¬ì„¬ ê²€ì¦ ì¤‘ ì˜¤ë¥˜: {}", e.getMessage());
            }
        }
        
        try (FileReader reader = new FileReader(file)) {
            List<WeeklyReport> reports = gson.fromJson(reader, TYPE);
            if (reports == null) {
                log.warn("íŒŒì¼ì´ ë¹„ì–´ìˆê±°ë‚˜ ì†ìƒë¨: {}", filePath);
                return restoreFromBackup(filePath);
            }
            return reports;
        } catch (Exception e) {
            log.error("íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨: {} - {}", filePath, e.getMessage());
            return restoreFromBackup(filePath);
        }
    }
    
    /**
     * ë°±ì—… íŒŒì¼ì—ì„œ ë³µì›
     */
    private List<WeeklyReport> restoreFromBackup(String filePath) {
        File backupFile = new File(filePath + ".backup");
        if (backupFile.exists()) {
            log.info("ë°±ì—… íŒŒì¼ì—ì„œ ë³µì› ì‹œë„: {}", backupFile.getAbsolutePath());
            try (FileReader reader = new FileReader(backupFile)) {
                List<WeeklyReport> reports = gson.fromJson(reader, TYPE);
                if (reports != null) {
                    // ë³µì›ëœ ë°ì´í„°ë¡œ ë©”ì¸ íŒŒì¼ ë®ì–´ì“°ê¸°
                    saveToFile(filePath, reports);
                    return reports;
                }
            } catch (Exception e) {
                log.error("ë°±ì—… íŒŒì¼ ë³µì› ì‹¤íŒ¨: {}", e.getMessage());
            }
        }
        return new ArrayList<>();
    }
}
```

---

## 3. ì˜¤ë¥˜ ì²˜ë¦¬ ë©”ì»¤ë‹ˆì¦˜ ë¶„ì„

### 3.1 ë°œê²¬ëœ ë¬¸ì œì 

#### ğŸ”´ **ì‹¬ê°: ê¸°ìˆ ì  ì •ë³´ ë…¸ì¶œ**

**ìœ„ì¹˜:** `WeeklyReportPanel.java:1084-1088`
```java
} catch (Exception e) {
    System.err.println("âœ— ë³´ê³ ì„œ ì €ì¥ ì‹¤íŒ¨: " + e.getMessage());
    e.printStackTrace();
    JOptionPane.showMessageDialog(this, "âŒ ì˜¤ë¥˜: " + e.getMessage(), "ì˜¤ë¥˜", JOptionPane.ERROR_MESSAGE);
}
```

**ë¬¸ì œì :**
- `e.getMessage()`ë¥¼ ì‚¬ìš©ìì—ê²Œ ì§ì ‘ í‘œì‹œí•˜ì—¬ ë‚´ë¶€ êµ¬í˜„ ì„¸ë¶€ì‚¬í•­ì´ ë…¸ì¶œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- `printStackTrace()`ê°€ ì½˜ì†”ì— ì¶œë ¥ë˜ì–´ ë¯¼ê°í•œ ì •ë³´ê°€ ë¡œê·¸ì— ë‚¨ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì˜ˆì‹œ:**
```
ì‚¬ìš©ìì—ê²Œ í‘œì‹œ: "âŒ ì˜¤ë¥˜: java.io.FileNotFoundException: C:\project\softoneAuto\data\weekly_reports\..."
â†’ íŒŒì¼ ì‹œìŠ¤í…œ ê²½ë¡œ, ë””ë ‰í† ë¦¬ êµ¬ì¡° ë“±ì´ ë…¸ì¶œë¨
```

#### ğŸŸ¡ **ì¤‘ê°„: ì˜ˆì™¸ ì²˜ë¦¬ ë¶ˆì¼ì¹˜**

**ìœ„ì¹˜:** `WeeklyReportPanel.java:702-733`
```java
} catch (Exception e) {
    System.err.println("âœ— ì£¼ê°„ë³´ê³ ì„œ ë¡œë“œ ì‹¤íŒ¨: " + e.getMessage());
    e.printStackTrace();
    
    // ë°±ì—…ìœ¼ë¡œ ë³µì› ì‹œë„
    cachedReports.clear();
    cachedReports.addAll(backupReports);
    
    JOptionPane.showMessageDialog(this, 
        "ë³´ê³ ì„œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n" + e.getMessage() + 
        "\n\nì´ì „ ëª©ë¡ì„ ìœ ì§€í•©ë‹ˆë‹¤.", 
        "ì˜¤ë¥˜", 
        JOptionPane.ERROR_MESSAGE);
}
```

**ë¬¸ì œì :**
- ì˜ˆì™¸ ë©”ì‹œì§€ë¥¼ ì‚¬ìš©ìì—ê²Œ ì§ì ‘ í‘œì‹œí•©ë‹ˆë‹¤.
- ë³µêµ¬ ë¡œì§ì´ ìˆì§€ë§Œ ì‚¬ìš©ìì—ê²ŒëŠ” ê¸°ìˆ ì  ì˜¤ë¥˜ë§Œ í‘œì‹œë©ë‹ˆë‹¤.

#### ğŸŸ¡ **ì¤‘ê°„: ì˜ˆì™¸ ë¬´ì‹œ**

**ìœ„ì¹˜:** `WeeklyReportRepository.java:237-240`
```java
} catch (Exception e) {
    System.err.println("íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨: " + filePath + " - " + e.getMessage());
    return new ArrayList<>(); // ì˜ˆì™¸ë¥¼ ë¬´ì‹œí•˜ê³  ë¹ˆ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜
}
```

**ë¬¸ì œì :**
- ì˜ˆì™¸ê°€ ë°œìƒí•´ë„ ë¹ˆ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•˜ì—¬ ìƒìœ„ ë ˆì´ì–´ì—ì„œ ì˜¤ë¥˜ë¥¼ ê°ì§€í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.
- ë°ì´í„° ì†ì‹¤ì´ ë°œìƒí–ˆëŠ”ì§€ ì•Œ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

### 3.2 ê°œì„  ë°©ì•ˆ

#### âœ… **í•´ê²°ì±… 1: ì‚¬ìš©ì ì¹œí™”ì  ì˜¤ë¥˜ ë©”ì‹œì§€**

```java
/**
 * ì˜ˆì™¸ë¥¼ ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€ë¡œ ë³€í™˜
 */
public class ErrorMessageMapper {
    
    public static String getUserFriendlyMessage(Exception e) {
        Throwable cause = e.getCause() != null ? e.getCause() : e;
        
        if (cause instanceof java.io.FileNotFoundException) {
            return "ë°ì´í„° íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\në°ì´í„°ê°€ ì†ìƒë˜ì—ˆê±°ë‚˜ ì‚­ì œë˜ì—ˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
        }
        
        if (cause instanceof java.io.IOException) {
            String message = cause.getMessage();
            if (message != null) {
                if (message.contains("ì‚¬ìš© ì¤‘") || message.contains("being used")) {
                    return "íŒŒì¼ì´ ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ì—ì„œ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤.\ní”„ë¡œê·¸ë¨ì„ ë‹«ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
                }
                if (message.contains("ê¶Œí•œ") || message.contains("permission")) {
                    return "íŒŒì¼ì— ì ‘ê·¼í•  ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.\nê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰í•˜ê±°ë‚˜ íŒŒì¼ ê¶Œí•œì„ í™•ì¸í•´ì£¼ì„¸ìš”.";
                }
                if (message.contains("ê³µê°„") || message.contains("space")) {
                    return "ë””ìŠ¤í¬ ê³µê°„ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.\në””ìŠ¤í¬ ê³µê°„ì„ í™•ë³´í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
                }
            }
            return "íŒŒì¼ ì½ê¸°/ì“°ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\në°ì´í„° í´ë”ì˜ ì ‘ê·¼ ê¶Œí•œì„ í™•ì¸í•´ì£¼ì„¸ìš”.";
        }
        
        if (cause instanceof com.google.gson.JsonSyntaxException) {
            return "ë°ì´í„° íŒŒì¼ì´ ì†ìƒë˜ì—ˆìŠµë‹ˆë‹¤.\në°±ì—… íŒŒì¼ì—ì„œ ë³µì›ì„ ì‹œë„í•©ë‹ˆë‹¤.";
        }
        
        if (cause instanceof java.time.format.DateTimeParseException) {
            return "ë‚ ì§œ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.\ní˜•ì‹: yyyy-MM-dd (ì˜ˆ: 2025-01-15)";
        }
        
        if (cause instanceof NumberFormatException) {
            return "ìˆ«ì í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.\nì˜¬ë°”ë¥¸ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.";
        }
        
        // ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜
        return "ì˜ˆê¸°ì¹˜ ì•Šì€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\në¬¸ì œê°€ ì§€ì†ë˜ë©´ ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.";
    }
    
    /**
     * ë¡œê·¸ì—ë§Œ ìƒì„¸ ì •ë³´ ê¸°ë¡
     */
    public static void logError(String context, Exception e) {
        log.error("{} ì˜¤ë¥˜ ë°œìƒ", context, e);
        // ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ëŠ” ë¡œê·¸ì—ë§Œ ê¸°ë¡
        if (log.isDebugEnabled()) {
            log.debug("ìƒì„¸ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤:", e);
        }
    }
}
```

**ì‚¬ìš© ì˜ˆì‹œ:**
```java
// WeeklyReportPanel.java
} catch (Exception e) {
    ErrorMessageMapper.logError("ë³´ê³ ì„œ ì €ì¥", e);
    String userMessage = ErrorMessageMapper.getUserFriendlyMessage(e);
    JOptionPane.showMessageDialog(this, 
        userMessage, 
        "ì˜¤ë¥˜", 
        JOptionPane.ERROR_MESSAGE);
}
```

#### âœ… **í•´ê²°ì±… 2: ì»¤ìŠ¤í…€ ì˜ˆì™¸ í´ë˜ìŠ¤**

```java
/**
 * ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ ì˜ˆì™¸
 */
public class ApplicationException extends Exception {
    private final ErrorCode errorCode;
    private final String userMessage;
    
    public ApplicationException(ErrorCode errorCode, String userMessage, Throwable cause) {
        super(userMessage, cause);
        this.errorCode = errorCode;
        this.userMessage = userMessage;
    }
    
    public ErrorCode getErrorCode() {
        return errorCode;
    }
    
    public String getUserMessage() {
        return userMessage;
    }
}

/**
 * ì˜¤ë¥˜ ì½”ë“œ ì—´ê±°í˜•
 */
public enum ErrorCode {
    FILE_NOT_FOUND("íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"),
    FILE_ACCESS_DENIED("íŒŒì¼ ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤"),
    FILE_LOCKED("íŒŒì¼ì´ ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ì—ì„œ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤"),
    DATA_CORRUPTED("ë°ì´í„° íŒŒì¼ì´ ì†ìƒë˜ì—ˆìŠµë‹ˆë‹¤"),
    DISK_FULL("ë””ìŠ¤í¬ ê³µê°„ì´ ë¶€ì¡±í•©ë‹ˆë‹¤"),
    INVALID_INPUT("ì…ë ¥ê°’ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤"),
    UNKNOWN_ERROR("ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤");
    
    private final String defaultMessage;
    
    ErrorCode(String defaultMessage) {
        this.defaultMessage = defaultMessage;
    }
    
    public String getDefaultMessage() {
        return defaultMessage;
    }
}
```

**ì‚¬ìš© ì˜ˆì‹œ:**
```java
// JsonRepository.java
public void saveAll(List<T> list) {
    try {
        // ì €ì¥ ë¡œì§
    } catch (FileNotFoundException e) {
        throw new ApplicationException(
            ErrorCode.FILE_NOT_FOUND,
            "ë°ì´í„° íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\në°ì´í„°ê°€ ì†ìƒë˜ì—ˆê±°ë‚˜ ì‚­ì œë˜ì—ˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
            e
        );
    } catch (IOException e) {
        String message = e.getMessage();
        if (message != null && message.contains("ì‚¬ìš© ì¤‘")) {
            throw new ApplicationException(
                ErrorCode.FILE_LOCKED,
                "íŒŒì¼ì´ ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ì—ì„œ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤.\ní”„ë¡œê·¸ë¨ì„ ë‹«ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",
                e
            );
        }
        throw new ApplicationException(
            ErrorCode.UNKNOWN_ERROR,
            "íŒŒì¼ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",
            e
        );
    }
}

// WeeklyReportPanel.java
} catch (ApplicationException e) {
    ErrorMessageMapper.logError("ë³´ê³ ì„œ ì €ì¥", e);
    JOptionPane.showMessageDialog(this, 
        e.getUserMessage(), 
        "ì˜¤ë¥˜", 
        JOptionPane.ERROR_MESSAGE);
} catch (Exception e) {
    ErrorMessageMapper.logError("ë³´ê³ ì„œ ì €ì¥", e);
    String userMessage = ErrorMessageMapper.getUserFriendlyMessage(e);
    JOptionPane.showMessageDialog(this, 
        userMessage, 
        "ì˜¤ë¥˜", 
        JOptionPane.ERROR_MESSAGE);
}
```

#### âœ… **í•´ê²°ì±… 3: ì˜ˆì™¸ ì „íŒŒ ë° ë³µêµ¬ ì „ëµ**

```java
/**
 * ì˜ˆì™¸ë¥¼ ë¬´ì‹œí•˜ì§€ ì•Šê³  ì ì ˆíˆ ì²˜ë¦¬
 */
public class WeeklyReportRepository {
    
    /**
     * íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ë¥¼ ì „íŒŒí•˜ì—¬ ìƒìœ„ ë ˆì´ì–´ì—ì„œ ì²˜ë¦¬
     */
    private List<WeeklyReport> loadFromFile(String filePath) throws DataLoadException {
        File file = new File(filePath);
        
        if (!file.exists()) {
            return new ArrayList<>();
        }
        
        try (FileReader reader = new FileReader(file)) {
            List<WeeklyReport> reports = gson.fromJson(reader, TYPE);
            if (reports == null) {
                throw new DataLoadException(
                    "íŒŒì¼ì´ ë¹„ì–´ìˆê±°ë‚˜ ì†ìƒë¨: " + filePath,
                    filePath
                );
            }
            return reports;
        } catch (com.google.gson.JsonSyntaxException e) {
            // JSON íŒŒì‹± ì˜¤ë¥˜: ë°±ì—…ì—ì„œ ë³µì› ì‹œë„
            log.warn("JSON íŒŒì‹± ì˜¤ë¥˜, ë°±ì—…ì—ì„œ ë³µì› ì‹œë„: {}", filePath);
            List<WeeklyReport> restored = restoreFromBackup(filePath);
            if (restored.isEmpty()) {
                throw new DataLoadException(
                    "ë°ì´í„° íŒŒì¼ì´ ì†ìƒë˜ì—ˆê³  ë°±ì—… ë³µì›ë„ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: " + filePath,
                    filePath,
                    e
                );
            }
            return restored;
        } catch (IOException e) {
            throw new DataLoadException(
                "íŒŒì¼ ì½ê¸° ì‹¤íŒ¨: " + filePath,
                filePath,
                e
            );
        }
    }
    
    /**
     * ì»¤ìŠ¤í…€ ì˜ˆì™¸ í´ë˜ìŠ¤
     */
    public static class DataLoadException extends Exception {
        private final String filePath;
        
        public DataLoadException(String message, String filePath) {
            super(message);
            this.filePath = filePath;
        }
        
        public DataLoadException(String message, String filePath, Throwable cause) {
            super(message, cause);
            this.filePath = filePath;
        }
        
        public String getFilePath() {
            return filePath;
        }
    }
}
```

---

## 4. ì¢…í•© ê°œì„  ê¶Œì¥ì‚¬í•­

### 4.1 ìš°ì„ ìˆœìœ„ë³„ ê°œì„  ê³„íš

#### ğŸ”´ **ìµœìš°ì„  (Critical)**
1. **ìŠ¤ë ˆë“œ ì•ˆì „ì„± ê°œì„ **
   - `cachedReports`ë¥¼ `CopyOnWriteArrayList` ë˜ëŠ” `synchronizedList`ë¡œ ë³€ê²½
   - `loadReports()`ì™€ `onReportSelected()`ì— ë™ê¸°í™” ë¸”ë¡ ì¶”ê°€
   - ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¤‘ë³µ ì œê±°

2. **ë°ì´í„° ë¬´ê²°ì„± ê²€ì¦ ì¶”ê°€**
   - SHA-256 í•´ì‹œ ê¸°ë°˜ ë¬´ê²°ì„± ê²€ì¦ êµ¬í˜„
   - ì €ì¥/ë¡œë“œ ì‹œ ì²´í¬ì„¬ ê²€ì¦

3. **ì˜¤ë¥˜ ë©”ì‹œì§€ ê°œì„ **
   - ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€ ë§¤í•‘ êµ¬í˜„
   - ê¸°ìˆ ì  ì •ë³´ ë…¸ì¶œ ë°©ì§€

#### ğŸŸ¡ **ì¤‘ìš” (High)**
4. **ì˜ˆì™¸ ì²˜ë¦¬ ì¼ê´€ì„±**
   - ì»¤ìŠ¤í…€ ì˜ˆì™¸ í´ë˜ìŠ¤ ë„ì…
   - ì˜ˆì™¸ ë¬´ì‹œ ì§€ì–‘, ì ì ˆí•œ ì „íŒŒ ë° ë³µêµ¬

5. **ë¡œê¹… ê°œì„ **
   - `System.out.println` ëŒ€ì‹  SLF4J ë¡œê±° ì‚¬ìš©
   - ë¡œê·¸ ë ˆë²¨ ì ì ˆíˆ ì„¤ì •

#### ğŸŸ¢ **ê¶Œì¥ (Medium)**
6. **ë°±ì—… ë° ë³µêµ¬ ë©”ì»¤ë‹ˆì¦˜ ê°•í™”**
   - ìë™ ë°±ì—… ìŠ¤ì¼€ì¤„ë§
   - ë³µêµ¬ í”„ë¡œì„¸ìŠ¤ ìë™í™”

7. **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì¶”ê°€**
   - ìŠ¤ë ˆë“œ ì•ˆì „ì„± í…ŒìŠ¤íŠ¸
   - ë°ì´í„° ë¬´ê²°ì„± í…ŒìŠ¤íŠ¸
   - ì˜ˆì™¸ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸

---

## 5. ê²°ë¡ 

ë³¸ ë¶„ì„ì„ í†µí•´ ë‹¤ìŒ ì„¸ ê°€ì§€ ì£¼ìš” ì˜ì—­ì—ì„œ ê°œì„ ì´ í•„ìš”í•¨ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤:

1. **ìŠ¤ë ˆë“œ ì•ˆì „ì„±**: í˜„ì¬ êµ¬í˜„ì€ ë™ì‹œ ì ‘ê·¼ ì‹œ ë°ì´í„° ë¶ˆì¼ì¹˜ ë° ì˜ˆì™¸ ë°œìƒ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.
2. **ë°ì´í„° ë¬´ê²°ì„±**: ì²´í¬ì„¬/í•´ì‹± ë©”ì»¤ë‹ˆì¦˜ì´ ì—†ì–´ ë°ì´í„° ë³€ì¡°ë¥¼ ê°ì§€í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
3. **ì˜¤ë¥˜ ì²˜ë¦¬**: ê¸°ìˆ ì  ì •ë³´ ë…¸ì¶œ ë° ì¼ê´€ì„± ì—†ëŠ” ì˜ˆì™¸ ì²˜ë¦¬ê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.

ì œì‹œëœ ê°œì„  ë°©ì•ˆì„ ë‹¨ê³„ì ìœ¼ë¡œ ì ìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì•ˆì •ì„±ê³¼ ë³´ì•ˆì„±ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

**ì‘ì„±ì¼:** 2025-01-XX  
**ë¶„ì„ ëŒ€ìƒ:** `softoneAuto` Java Swing ì• í”Œë¦¬ì¼€ì´ì…˜  
**ë¶„ì„ ë²”ìœ„:** í•µì‹¬ ë°ì´í„° ì²˜ë¦¬ ë¡œì§ (WeeklyReportPanel, JsonRepository, WeeklyReportRepository)

